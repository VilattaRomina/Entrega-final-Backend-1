<div class="row">
  <div class="col-12 mb-3">
    <a href="/products" class="btn btn-outline-secondary">
      <i class="fas fa-arrow-left"></i> Volver a productos
    </a>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    {{#if product.thumbnails.[0]}}
      <img src="{{product.thumbnails.[0]}}" class="img-fluid rounded" alt="{{product.title}}">
    {{else}}
      <div class="bg-secondary d-flex align-items-center justify-content-center rounded" style="height: 400px;">
        <i class="fas fa-image fa-5x text-white"></i>
      </div>
    {{/if}}
    
    {{#if product.thumbnails}}
      <div class="row mt-3">
        {{#each product.thumbnails}}
          <div class="col-3">
            <img src="{{this}}" class="img-thumbnail" alt="Imagen del producto">
          </div>
        {{/each}}
      </div>
    {{/if}}
  </div>
  
  <div class="col-md-6">
    <h1>{{product.title}}</h1>
    <p class="text-muted">Código: {{product.code}}</p>
    
    <hr>
    
    <h3 class="text-primary">${{product.price}}</h3>
    
    <p class="mt-3">
      {{#if product.status}}
        <span class="badge bg-success">En stock: {{product.stock}} unidades</span>
      {{else}}
        <span class="badge bg-danger">Sin stock</span>
      {{/if}}
    </p>
    
    <p class="mt-3">
      <strong>Categoría:</strong> <span class="badge bg-secondary">{{product.category}}</span>
    </p>
    
    <hr>
    
    <h5>Descripción</h5>
    <p>{{product.description}}</p>
    
    <hr>
    
    {{#if product.status}}
    <div class="mt-4">
      <div class="input-group mb-3" style="max-width: 200px;">
        <button class="btn btn-outline-secondary" type="button" onclick="decreaseQuantity()">-</button>
        <input type="number" class="form-control text-center" id="quantity" value="1" min="1" max="{{product.stock}}">
        <button class="btn btn-outline-secondary" type="button" onclick="increaseQuantity()">+</button>
      </div>
      
      <button class="btn btn-success btn-lg w-100" onclick="addToCart()">
        <i class="fas fa-shopping-cart"></i> Agregar al carrito
      </button>
    </div>
    {{else}}
    <div class="alert alert-warning mt-4">
      <i class="fas fa-exclamation-triangle"></i> Producto no disponible
    </div>
    {{/if}}
  </div>
</div>

<script>
const productId = '{{product._id}}';
const maxStock = {{product.stock}};

function increaseQuantity() {
  const input = document.getElementById('quantity');
  const currentValue = parseInt(input.value);
  if (currentValue < maxStock) {
    input.value = currentValue + 1;
  }
}

function decreaseQuantity() {
  const input = document.getElementById('quantity');
  const currentValue = parseInt(input.value);
  if (currentValue > 1) {
    input.value = currentValue - 1;
  }
}

function addToCart() {
  const quantity = document.getElementById('quantity').value;
  alert(`Agregando ${quantity} unidad(es) del producto al carrito`);
  // Aquí puedes hacer una petición POST a /api/carts/:cid/products/:pid
}
</script>

